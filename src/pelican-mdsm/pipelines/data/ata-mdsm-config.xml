<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE pelican>

<configuration version="1.0">

    <pipeline>
        <buffers>
           <SpectrumDataSetStokes>
               <buffer maxSize="100000000" maxChunkSize="100000000"/>
           </SpectrumDataSetStokes>
        </buffers>

        <adapters>
            <RawVoltageAdapter>
                <sampleSize bits="16"/>
                <samplesPerRead number="128" />
                <subbands number="1" />
		        <polarisations number="1" />
            </RawVoltageAdapter>
        </adapters>

        <clients>
            <FileDataClient>
                <data type="TimeSeriesDataSetC32" adapter="RawVoltageAdapter" file="/home/lessju/Code/MDSM/Tests/ATA/ataPsrb0450.dat"/>
            </FileDataClient>
        </clients>

        <modules>

            <PPFChanneliser>
                <outputChannelsPerSubband value="128" />
                <processingThreads value="1" />
                <filter nTaps="2" filterWindow="kaiser" />
            </PPFChanneliser>

            <StokesGenerator />

            <MdsmModule>
                <observationfile filepath="/home/lessju/Code/MDSM/Tests/ATA/crabAta.xml" />
                <createOutputBlob value="0" />
            </MdsmModule>

        </modules>

        <output>
            <dataStreams>
                <stream name="SpectrumDataSetStokes" listeners="SigprocStokesWriter"/>
                <stream name="DedispersedTimeSeriesF32" listeners="DedispersedDataWriter"/>
            </dataStreams>
            <streamers>
                <SigprocStokesWriter>
                    <file filepath="ata_channelised_data.dat" />
<!--                    <subbandsPerPacket value="1" />-->
<!--                    <totalComplexSubbands value="1" />-->
<!--                    <clock value="17.462" />-->
<!--                    <integrateTimeBins value="1" />-->
<!--                    <topChannelFrequency value="1428.71" />-->
<!--                    <outputChannelsPerSubband value="128" />-->
                </SigprocStokesWriter>
                <DedispersedDataWriter>
                    <file prefix="ataTest" />
<!--                    <params channelOneFrequency="1424"-->
<!--                            frequencyOffset="-0.002954"-->
<!--                            numberOfChannels="1"-->
<!--                            samplingTime="330" />-->
                    <DMs values="15" />
                </DedispersedDataWriter>

            </streamers>
        </output>
    </pipeline>
</configuration>
